<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">
  <title>Document</title>
</head>

<body>
  <header>
    <div class="funcionario">
      <img src="img\usuario-do-circulo.png" alt="foto de perfil">
      <h3></h3>
    </div>

    <div class="deslogar">
      <h3>Sair</h3>
      <img src="img\sair.png" alt="sair">
    </div>
  </header>

    <main>
      <div class="geral">
        <div class="container_op">

          <div class="opcao">
            <div id="dados">
              <h3>Setor</h3>
              <h3>Nome do Usu√°rio</h3>
            </div>
            <div class="info-container">
              <div class="info-item">
                <img src="img/historico.png" alt="Hist√≥rico">
                <h3>Hist√≥rico</h3>
              </div>
              <div class="info-item">
                <img src="img/detalhamento.png" alt="Detalhamento de M√°quina">
                <h3>Detalhamento de M√°quina</h3>
              </div>
              <div class="info-item">
                <img src="img/agenda.png" alt="Agendar Manuten√ß√£o">
                <h3>Agendar Manuten√ß√£o</h3>
              </div>
              <div class="info-item">
                <img src="img/documentacao.png" alt="Registro de Manuten√ß√£o">
                <h3>Registro de Manuten√ß√£o</h3>
              </div>
            </div>
          </div>
        </div>

        <div class="cont_perfil_maquina">
          <div class="perfil">
            <div class="perfil-info">
              <p><strong>Nome</strong> | Cargo</p>
              <p>N√≠vel de acesso | adm</p>
            </div>
            <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Usu√°rio">
          </div>
          <div class="maquinas">
            <div class="lista-maquinas" id="listaMaquinas"></div>
            <!-- Bot√£o "Adicionar M√°quina" separado da lista -->
            <div class="add-maquina">
                <a href="cadastro_maquina.html">
                    <img id="add_m" src="img/mais.png" alt="Adicionar M√°quina">
                </a>
            </div>
        </div>
        </div>

      </div>



    </main>
  </body>

  </html>


  <script>
    // Pegando o nome do usu√°rio corretamente
    const user = JSON.parse(localStorage.getItem("user")); // Converte JSON para objeto

    if (user && user.name) {
      document.querySelector(".funcionario h3").textContent = user.name;
    } else {
      window.location.href = "login.html"; // Se n√£o estiver logado, redireciona
    }

    function carregarMaquinas() {
      const listaMaquinas = document.getElementById("listaMaquinas");
      listaMaquinas.innerHTML = ""; // Limpa antes de carregar
  
      let maquinas = JSON.parse(localStorage.getItem("maquinas")) || [];
  
      maquinas.forEach((maquina, index) => {
          const maquinaItem = document.createElement("div");
          maquinaItem.classList.add("maquina-item");
          maquinaItem.innerHTML = `
              <p><strong>${maquina.nome} | ${maquina.codigo}</strong></p>
              <p>${maquina.setor}</p>
              <p><strong>ESTADO:</strong> ${maquina.estado}</p>
              <button class="remover-btn" onclick="removerMaquina(${index})">üóëÔ∏è Remover</button>
          `;
          listaMaquinas.appendChild(maquinaItem);
      });
  
      // Garante que o bot√£o "Adicionar M√°quina" sempre esteja presente
      let addMaquina = document.querySelector(".add-maquina");
      if (!document.contains(addMaquina)) {
          addMaquina = document.createElement("div");
          addMaquina.classList.add("add-maquina");
          addMaquina.innerHTML = `
              <a href="cadastro_maquina.html" style="display: block; width: 100%; height: 100%;">
                  <img id="add_m" src="img/mais.png" alt="Adicionar M√°quina">
              </a>
          `;
      }
      addMaquina.addEventListener("click", () => {
          window.location.href = "cadastro_maquina.html";
      });
      listaMaquinas.appendChild(addMaquina);
  }
  
  document.addEventListener("DOMContentLoaded", carregarMaquinas);
  
  function removerMaquina(index) {
      let maquinas = JSON.parse(localStorage.getItem("maquinas")) || [];
      maquinas.splice(index, 1);
      localStorage.setItem("maquinas", JSON.stringify(maquinas));
      carregarMaquinas(); // Atualiza a lista
  }
  
  // Adiciona estilo para o bot√£o de remover
  const style = document.createElement("style");
  style.innerHTML = `
      .remover-btn {
          background-color: #ff4d4d;
          color: white;
          border: none;
          margin: 5px;
          padding: 4px 9px;
          border-radius: 5px;
          cursor: pointer;
          transition: background-color 0.3s ease;
      }
      .remover-btn:hover {
          background-color: #cc0000;
      }
  `;
  document.head.appendChild(style);
  </script>
</body>

</html>